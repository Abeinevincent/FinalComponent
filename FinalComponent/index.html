<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans" />
  <link href="http://fonts.cdnfonts.com/css/montserrat" rel="stylesheet" />
  <title>Oblig 1 | Web components | IDG2100</title>
  <link rel="stylesheet" href="./assets/core.css" />
  <link rel="stylesheet" href="./assets/style.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
</head>

<body class="container">
  <header class="pt-2">
    <!-- Replace based on your project -->
    <h1>Oblig 1 - Joke generator</h1>
  </header>
  <main>
    <article>
      <!-- Replace based on your project -->
      <h2>Check my favourite Jokes</h2>
      <!-- Delete all <li> elements in your
            project and use JS to populate this list -->
      <ul class="list-cotainer"></ul>
    </article>
  </main>

  <aside>
    <!-- Replace based on your project -->
    <joke-generator></joke-generator>
  </aside>
  <footer>
    <!-- Replace based on your project -->
    <p class="text-center mt-2">
    </p>
  </footer>

  <script src="./components/JokeGenerator.js"></script>
  <script>
    const listContainer = document.querySelector(".list-cotainer");
    document.addEventListener("joke-selected", (e) => {
      let joke = e.detail.joke;
      const listItem = document.createElement("li");
      listItem.innerText = joke;
      listContainer.appendChild(listItem);
    });

    const listItem = document.createElement("li");

    // Send list items to the local storage and then retrieve them onpage load
    let savedData = localStorage.setItem("listItem", JSON.stringify(listItem))

    // Retrieve saved data
    document.addEventListener("DOMContentLoaded", (e) => {
      const retrievedData = localStorage.getItem("savedData");
      // // JSON.parse(retrievedData)
      // // console.log(JSON.parse(retrievedData));

      if(retrievedData) {
        listContainer.appendChild(...listItem, JSON.parse(retrievedData));
      }

    })


    // populate the list on page load from localStorage
    let storedItems = localStorage.getItem('savedData');
    if (storedItems) {
      JSON.parse(storedItems).forEach(function(item) {
        saveFavourites(item);
      })
    }

  


    const dt = new Date();
    const currentDate = dt.toISOString().slice(0, 10);
    const name_date = `Amaan ${currentDate}`;
    document.querySelector('footer p').textContent = name_date;

  </script>
</body>

</html>